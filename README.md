# Pcfb_Final_Project
Course: Bioinformatics
Owner: K. Kort
Contributor: H. Kruize
Aim of this Git: Store scripts and programs for the "Multiple Sequence Alignment - Phylogenetic tree" pipeline


To run the program type : './pipeline.py "[prot_name]\*[.file extention]"'
This will allow the program to select all files associated with prot_name, both .fnt (for nucleotide) and .faa (for amino acids).
Single file names can also be used as an argument.

To run the script the following programs are needed:
-Python
-Biopython
-python-networkx
-pylab (or an equal)
-pydot (or an equal)
-MAFFT
-Phylip

Our pipeline is written in a python wrapper so that we can better handle program arguments.
It creates a working directory where all the working files are placed.
The final result (Phylo_tree.png) will be placed in the folder where the pipeline.py is located.

Data retrieval:
To test the pipeline two toy datasets were retrieved from the MiST2.2 database.
2 Files: DNA sequences for CheZ of 2 times 10 different species (.fnt)
2 Files: protein sequences for CheZ of 2 times 10 different species (.faa)

Search RefSeq genename for CheZ, was used to retrieve the data. These sequences were retrieved manually and the species included are the first 20 in the list.

From the input file the amount of sequences are determined.
Next the sequence names are sorted, counted, and written to seq_names.txt and printed to the screen.
All the input sequences files are combined to generate one general input file. This will make calling arguments less tedious and more general. Additionally the number of inputfiles given by the user can vary in number.

In this file, input.fas, the sequences are spread over multiple lines. The line endings could be removed with an advanced search and replace in gedit (Search: ([ACGT])\n([ACGT]), Replace: \1\2). However we prefer to make this an automated process if possible.
However this seems not to be an issue for the multiple sequence alignment with the following two aligners: MUSCLE and MAFFT.
They accept newlines between the sequences.

USING MULTIPLE SEQUENCE ALIGNERS:
We test the multiple sequence alignment methods muscle and mafft with default settings first.
os.system('mafft input.fas > mafft(\_)output.fas')
os.system('muscle -in input.fas -out muscle(\_)output.fas')

We tested both MAFFT and MUSCLE, eventually we settled on using MAFFT with the following input argument:
###########################

Two freely available methods/packages were tried to construct the phylogenetic tree: Phylip and MEGA. MEGA claims to have command line functionality, yet when we want to run a function it opens a GUI. This is not what we want, because we want a fully automated pipeline. So we decided to continue with Phylip.

USING PHYLIP:
The output file generated by MAFFT is not compatible with Phylip. Therefore, the MSA output file has to be reformatted.
The input format for Phylip is as follows:
[number of sequences]\t[length of the aligned sequence]
Sequence_name1 Sequence1.1
Sequence_name2 Sequence2.1

Sequence_name1 Sequence1.2
Sequence_name2 Sequence2.2
etc.

This format is automatically generated by the pipeline, see pipeline.py for further comments.

First a distance matrix has to be made based on the multiple sequence alignment.
For protein sequences the command phylip protdist has to be used, for dna sequences the command phylip dnadist needs to be used to generate the distance matrix. The pipeline determines which one has to be used based upon the file extension presented first in the input argument.
Phylip prot/dnadist uses default parameters.

The pipeline now uses the calculated distance matrix as an input for phylip neighbor to generate the phylogenetic tree.
Phylip neighbor uses default parameters.

For the visualisation of the phylogenetic tree the Phylo package from Biopython was used instead of the drawgram function in phylip. This allows for user optimization of the representation of the phylogenetic tree. For now we used default parameters and a .png is generated.

The pipeline was tested with a more elaborated large test set of the protein CheV, 222 amino acids/ nucleotides sequences.
